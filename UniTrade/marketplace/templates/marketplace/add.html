{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8"> <!---Character encoding-->
    <meta http-equiv="X-UA-Compatible" content="IE-edge">
    <meta name = "viewport" content = "width=device-width, initial-scale=1.0"> <!--For Different device (Compatibility)-->

    <!-- External Libraries-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">


    <link rel = "stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">


    <link rel="stylesheet" href="{% static 'css/photoUpload.css' %}">

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <title> Navbar</title>

</head>

<body>
    <!---------------------------NAVIGATION BAR------------------------------>
    <section id="nav-bar">
        <div class="container"> 
            <nav class="navbar navbar-expand-lg bg-body-tertiary" style="height: 80px;">

                
                <a href="{% url 'condition' %}" class="icon-link d-flex justify-content-center align-items-center" style="width: 30%; height: 100%;">
                    <i class="fas fa-chevron-circle-left"></i> <!-- Plus icon -->
                </a>


                <div class="container-fluid">
                    <a class="navbar-brand-sell" href="Products.html" style="text-decoration: none;">UniTrade</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    </div>
                </div>
            </nav>
        </div>
    </section>




    <!------------------------Complete Listing ----------------------------->

    <section id="listing">

        <div class="container">


            <br>
            <br>
            <h1>Complete your Listing</h1>
            <hr>    
            <br>

            <h3>Item Specifics</h3>

            <br>

            <form>
                <div class="row mb-3">
                  <label for="inputEmail3" class="col-sm-2 col-form-label">Title</label>
                  <div class="col-sm-10">
                    <input type="email" class="form-control" id="inputEmail3">
                  </div>
                </div>
                <div class="row mb-3">
                    <label for="inputBrand3" class="col-sm-2 col-form-label">Brand</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="brand3">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="inputPassword3" class="col-sm-2 col-form-label">Department</label>
                    <div class="col-sm-10">
                        <select class="form-select" aria-label="Default select example">
                            <option selected>Select the department</option>
                            <option value="1">One</option>
                            <option value="2">Two</option>
                            <option value="3">Three</option>
                          </select>
                    </div>
                  </div>

                  <div class="row mb-3">
                    <label for="inputPrice" class="col-sm-2 col-form-label">Price</label>
                    <div class="col-sm-10">
                      <div class="input-group-text">
                        <span class="input-group-text">Â£</span>
                        <input type="text" class="form-control" id="inputPrice" placeholder="Enter price">
                      </div>
                    </div>
                  </div>

                  <div class="mb-3 row">
                    <label for="staticEmail" class="col-sm-2 col-form-label">Condition</label>
                    <div class="col-sm-10">
                      <input type="text" readonly class="form-control-plaintext" id="staticEmail" value="Pre-owned">
                      <br>
                    </div>


                  <div class="mb-3">
                    <label for="exampleFormControlTextarea1" class="form-label">Product Description</label>
                    <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
                  </div>
                
              </form>

              <br>

              <hr>
              <br>
              <br>



            <div class="heading">
                <h2>Photos & Video</h2>
                <h3>Buyers want to see all details and angles. Tips for taking pro photos!</h3>
            </div>
            <br>
            <br>
            <br>
            
      
            


        <div class="input-div">
            <p>Drag & drop photos here or <span class="browse">Browse</span></p>
            <input type="file" class="file" multiple="multiple" accept="image/jpeg, image/png, image/jpg" />
          </div>

          <br>  

        <form id="queued-form">
            <br>            
            <div class="queued-div"></div>
            

            <br>
            <br>
          </form>
        </div>

        <div class="Confirm-button">
          <button type="submit">Upload</button>
        </div>

          <br>



          
            <script>
  
                // 1
                let queuedImagesArray = [],
                  savedForm = document.querySelector("#saved-form"),
                  queuedForm = document.querySelector("#queued-form"),
                  savedDiv = document.querySelector('.saved-div'),
                  queuedDiv = document.querySelector('.queued-div'),
                  inputDiv = document.querySelector('.input-div'),
                  input = document.querySelector('.input-div input'),
                  serverMessage = document.querySelector('.server-message'),
                  deleteImages = [];
            
                // SAVED IN SERVER - We'll complete in part 2
            
                // QUEUED IN FRONTEND
                function displayQueuedImages() {
                  let images = "";
                  queuedImagesArray.forEach((image, index) => {
                    images += `<div class="image">
                                <img src="${URL.createObjectURL(image)}" alt="image">
                                <span onclick="deleteQueuedImage(${index})">&times;</span>
                              </div>`;
                  })
                  queuedDiv.innerHTML = images;
                }
            
                function deleteQueuedImage(index) {
                  queuedImagesArray.splice(index, 1);
                  displayQueuedImages();
                }
            
                input.addEventListener("change", () => {
                  const files = input.files;
                  for (let i = 0; i < files.length; i++) {
                    queuedImagesArray.push(files[i])
                  }
                  queuedForm.reset();
                  displayQueuedImages()
                })
            
                inputDiv.addEventListener("drop", (e) => {
                   e.preventDefault()
                  const files = e.dataTransfer.files
                  for (let i = 0; i < files.length; i++) {
                    if (!files[i].type.match("image")) continue; // only photos
            
                    if (queuedImagesArray.every(image => image.name !== files[i].name))
                      queuedImagesArray.push(files[i])
                  }
                  displayQueuedImages()
                })
            
                queuedForm.addEventListener("submit", (e) => {
                  e.preventDefault()
                  sendQueuedImagesToServer()
                });    
            
                function sendQueuedImagesToServer() {
                  const formData = new FormData(queuedForm);
            
                  queuedImagesArray.forEach((image, index) => {
                    formData.append(`file[${index}]`, image)
                  })
            
                  fetch("upload", {
                    method: "POST",
                    body: formData
                  })
            
                  .then(response => {
                    if (response.status !== 200) throw Error(response.statusText)
                    location.reload()
                  })
            
                  .catch(error => {
                    serverMessage.innerHTML = error
                    serverMessage.style.cssText = "background-color: #f8d7da; color:#b71c1c"
                  });
            
                }
            
              </script>

    
</body>          


    